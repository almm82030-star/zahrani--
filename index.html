<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª - Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ</title>
  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <style>
    body {
      background-color: #f4f6f9;
      font-family: "Tahoma", sans-serif;
    }
    header {
      background: linear-gradient(90deg, #0d6efd, #0056b3);
      padding: 15px;
      text-align: center;
      color: white;
      margin-bottom: 25px;
      border-radius: 0 0 20px 20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
    }
    header img {
      max-height: 80px;
      margin-bottom: 10px;
    }
    header h1 {
      font-size: 1.8rem;
      font-weight: bold;
    }
    .card {
      border-radius: 15px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.1);
      border: none;
      margin-bottom: 25px;
    }
    h5 {
      color: #0d6efd;
      margin-bottom: 20px;
    }
    th {
      background: #0d6efd;
      color: white;
      text-align: center;
    }
    td {
      text-align: center;
    }
    .btn-primary {
      background: #0d6efd;
      border: none;
    }
    .btn-primary:hover {
      background: #004085;
    }
    .btn-success {
      background: #198754;
      border: none;
    }
    .btn-success:hover {
      background: #146c43;
    }
  </style>
</head>
<body class="container py-4">

  <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± Ù…Ø¹ Ø§Ù„Ø´Ø¹Ø§Ø± -->
  <header>
    <img src="https://assets.zyrosite.com/cdn-cgi/image/format=auto,w=375,fit=crop,q=95/dOqNLp8LNNTl7Vlk/alzahrani-logistics-corporate-logo-photoroom-AR03Qav69VTGKk9B.png" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ">
    <h1>ğŸ“‹ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª</h1>
  </header>

  <!-- Ø±ÙØ¹ Ù…Ù„Ù Ø¥ÙƒØ³Ù„ -->
  <div class="card p-4">
    <h5>ğŸ“‚ Ø±ÙØ¹ Ù…Ù„Ù Excel</h5>
    <input type="file" id="excelFile" accept=".xlsx,.xls" class="form-control mb-3">
    <button class="btn btn-success" onclick="loadExcel()">Ø±ÙØ¹ ÙˆØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
  </div>

  <!-- Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø­Ø« -->
  <div class="card p-4">
    <h5>ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…Ø±ÙƒØ¨Ø©</h5>
    <form id="searchForm" class="row g-3">
      <div class="col-md-6">
        <label class="form-label">Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù… Ø§Ù„Ø´Ø§ØµÙŠ</label>
        <input type="text" id="searchChassis" class="form-control" placeholder="Ù…Ø«Ø§Ù„: ABC123456789">
      </div>
      <div class="col-md-6">
        <label class="form-label">Ø¨Ø­Ø« Ø¨Ø§Ù„Ù„ÙˆÙ†</label>
        <input type="text" id="searchColor" class="form-control" placeholder="Ù…Ø«Ø§Ù„: Ø£Ø¨ÙŠØ¶">
      </div>
      <div class="col-12">
        <button type="submit" class="btn btn-primary mt-3">Ø¨Ø­Ø«</button>
      </div>
    </form>
  </div>

  <!-- Ø¬Ø¯ÙˆÙ„ Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ -->
  <div class="card p-4">
    <h5>ğŸ“‘ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</h5>
    <div class="table-responsive">
      <table class="table table-bordered table-hover" id="resultsTable">
        <thead>
          <tr>
            <th>Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©</th>
            <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
            <th>Ø³Ù†Ø© Ø§Ù„ØµÙ†Ø¹</th>
            <th>Ø¨Ù„Ø¯ Ø§Ù„ØµÙ†Ø¹</th>
            <th>Ø±Ù‚Ù… Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© (Ø§Ù„Ø´Ø§ØµÙŠ)</th>
            <th>Ø±Ù‚Ù… Ø§Ù„Ù…Ø­Ø±Ùƒ</th>
            <th>Ø§Ù„Ù„ÙˆÙ†</th>
            <th>Ø§Ù„ÙˆØ²Ù†</th>
            <th>Ø§Ù„Ø­Ù…ÙˆÙ„Ø©</th>
            <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø±ÙƒØ§Ø¨</th>
            <th>Ù‚ÙˆØ© Ø§Ù„Ù…Ø­Ø±Ùƒ</th>
            <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯</th>
            <th>Ø±Ù‚Ù… Ø§Ù„Ø¨ÙŠØ§Ù† Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠ</th>
            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨ÙŠØ§Ù†</th>
            <th>Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠØ©</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- Ù…ÙƒØªØ¨Ø© Ù‚Ø±Ø§Ø¡Ø© Excel -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    let cars = JSON.parse(localStorage.getItem("cars")) || [];

    const resultsTable = document.querySelector("#resultsTable tbody");
    const searchForm = document.getElementById("searchForm");

    // Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„
    function renderTable(data) {
      resultsTable.innerHTML = "";
      if (data.length === 0) {
        resultsTable.innerHTML = "<tr><td colspan='15'>âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª</td></tr>";
        return;
      }
      data.forEach(car => {
        let row = "<tr>";
        Object.values(car).forEach(val => {
          row += `<td>${val || ""}</td>`;
        });
        row += "</tr>";
        resultsTable.innerHTML += row;
      });
    }

    // ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Excel
    function loadExcel() {
      const file = document.getElementById("excelFile").files[0];
      if (!file) {
        alert("âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Excel Ø£ÙˆÙ„Ø§Ù‹");
        return;
      }

      const reader = new FileReader();
      reader.onload = function(e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, {type: "array"});
        const sheetName = workbook.SheetNames[0];
        const sheet = workbook.Sheets[sheetName];
        const jsonData = XLSX.utils.sheet_to_json(sheet);

        // Ù†Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        cars = jsonData.map(row => ({
          card_number: row["Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©"] || "",
          date: row["Ø§Ù„ØªØ§Ø±ÙŠØ®"] || "",
          year: row["Ø³Ù†Ø© Ø§Ù„ØµÙ†Ø¹"] || "",
          country: row["Ø¨Ù„Ø¯ Ø§Ù„ØµÙ†Ø¹"] || "",
          chassis: row["Ø±Ù‚Ù… Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© (Ø§Ù„Ø´Ø§ØµÙŠ)"] || "",
          engine: row["Ø±Ù‚Ù… Ø§Ù„Ù…Ø­Ø±Ùƒ"] || "",
          color: row["Ø§Ù„Ù„ÙˆÙ†"] || "",
          weight: row["Ø§Ù„ÙˆØ²Ù†"] || "",
          capacity: row["Ø§Ù„Ø­Ù…ÙˆÙ„Ø©"] || "",
          passengers: row["Ø¹Ø¯Ø¯ Ø§Ù„Ø±ÙƒØ§Ø¨"] || "",
          engine_power: row["Ù‚ÙˆØ© Ø§Ù„Ù…Ø­Ø±Ùƒ"] || "",
          importer: row["Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯"] || "",
          customs_no: row["Ø±Ù‚Ù… Ø§Ù„Ø¨ÙŠØ§Ù† Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠ"] || "",
          customs_date: row["ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨ÙŠØ§Ù†"] || "",
          fees: row["Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠØ©"] || ""
        }));

        localStorage.setItem("cars", JSON.stringify(cars));
        renderTable(cars);
        alert("âœ… ØªÙ… Ø±ÙØ¹ ÙˆØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­");
      };
      reader.readAsArrayBuffer(file);
    }

    // Ø§Ù„Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù… Ø§Ù„Ø´Ø§ØµÙŠ Ø£Ùˆ Ø§Ù„Ù„ÙˆÙ†
    searchForm.addEventListener("submit", function(e) {
      e.preventDefault();
      const chassis = document.getElementById("searchChassis").value.trim();
      const color = document.getElementById("searchColor").value.trim();

      let results = [];
      if (chassis) {
        results = cars.filter(car => car.chassis === chassis);
      } else if (color) {
        results = cars.filter(car => car.color.includes(color));
      }

      renderTable(results);
    });

    // Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
    renderTable([]);
  </script>
</body>
</html>

